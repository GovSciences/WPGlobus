var WPGlobusCustomize;jQuery(document).ready(function(e){"use strict";if("undefined"!=typeof WPGlobusCoreData.customize){var t={languages:{},index:0,length:0,positionSet:!1,selectorHtml:'<span style="margin-left:5px;" class="wpglobus-icon-globe"></span><span style="font-weight:bold;">{{language}}</span>',init:function(o){e.each(WPGlobusCoreData.enabled_languages,function(e,o){t.languages[e]=o,t.length=e}),t.addLanguageSelector(),t.setElements(),t.addListeners()},setTitle:function(){e(WPGlobusCoreData.customize.info.element).html(WPGlobusCoreData.customize.info.html)},getString:function(t){var o=WPGlobusCore.getTranslations(t),n=[],a=0;return e.each(o,function(e,t){n[a]=""==t?"null":t,a++}),n=n.join(":::")},setElements:function(){t.setTitle();var o;e.each(WPGlobusCoreData.customize.addElements,function(n,a){var s=e(a.element);s.attr("id",n).val(a.value).trigger("change"),"textarea"==a.type&&"undefined"!=typeof a.textarea_attrs&&s.addClass(a.textarea_attrs["class"]),"undefined"!=typeof a.options&&("undefined"!=typeof a.options.setValue&&a.options.setValue&&(o=e(a.origin_element).val(),s.data("source",o),s.val(WPGlobusCore.TextFilter(o,WPGlobusCoreData.language,"RETURN_EMPTY")),s.hasClass("wpglobus-control-url")&&e(a.origin_element).val(t.getString(o))),"undefined"!=typeof a.options.setLabel&&a.options.setLabel&&(e(a.title).text(e(a.origin_title).text()),e(a.description).text(e(a.origin_description).text()))),s.on("change",function(o){var n=e(this),a=e(WPGlobusCoreData.customize.addElements[e(this).data("customize-setting-link")].origin_element);n.data("source",WPGlobusCore.getString(n.data("source"),n.val())),n.hasClass("wpglobus-control-url")?a.val(t.getString(n.data("source"))):a.val(WPGlobusCore.getString(a.val(),n.val())),n.hasClass("wpglobus-not-trigger-change")||a.trigger("change")})})},addLanguageSelector:function(){e('<a style="margin-left:48px;" class="customize-controls-close wpglobus-customize-selector"><span class="wpglobus-globe"></span></a>').insertAfter(".customize-controls-preview-toggle"),e(".wpglobus-customize-selector").html(t.selectorHtml.replace("{{language}}",WPGlobusCoreData.language))},setPosition:function(t){if("undefined"!=typeof t.options.setPosition&&t.options.setPosition){var o=e(t.parent).detach();o.insertBefore(t.origin_parent),e(t.parent).css({display:"block"})}},addListeners:function(){e(document).on("click",".control-section",function(o){t.positionSet||(t.positionSet=!0,e.each(WPGlobusCoreData.customize.addElements,function(o,n){e(n.origin_parent).css({display:"none"}),e(n.origin_parent+" label").css({display:"none"}),"undefined"!=typeof n.options&&t.setPosition(n)}))}),e(document).on("click",".wpglobus-customize-selector",function(o){t.index>t.length-1?t.index=0:t.index++,WPGlobusCoreData.language=t.languages[t.index],e(this).html(t.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),e(".wpglobus-customize-control").each(function(t,o){if("undefined"!=typeof WPGlobusCoreData.customize.addElements[e(o).data("customize-setting-link")]){var n=e(WPGlobusCoreData.customize.addElements[e(o).data("customize-setting-link")].origin_element),a=e(o);a.hasClass("wpglobus-control-url")?a.val(WPGlobusCore.TextFilter(a.data("source"),WPGlobusCoreData.language,"RETURN_EMPTY")):a.val(WPGlobusCore.TextFilter(n.val(),WPGlobusCoreData.language,"RETURN_EMPTY"))}})}),e(document).ajaxSend(function(t,o,n){if("undefined"!=typeof n.data&&n.data.indexOf("action=customize_save")>=0){var a,s,i=n.data.split("&");e.each(i,function(e,t){return a=t.split("="),"customized"==a[0]?void(s=a[1]):void 0});var l=decodeURIComponent(s);l=JSON.parse(l),e.each(WPGlobusCoreData.customize.addElements,function(t,o){"undefined"!=typeof l[t]&&(l[o.origin]=e(WPGlobusCoreData.customize.addElements[t].origin_element).val())}),n.data=n.data.replace(s,JSON.stringify(l))}})}};WPGlobusCustomize=e.extend({},WPGlobusCustomize,t),WPGlobusCustomize.init()}});
!function(e){"use strict";if("undefined"!=typeof WPGlobusWidgets){var t={init:function(){t.addElements(),t.attachListeners()},wysiwygClean:function(){e(".wpglobus-dialog-field").each(function(t,i){var a=e(i).data("source-id");if(1==e("#"+a+"-tmce").size()){var n=e(i).next(".wpglobus_dialog_start");e(i).remove(),e(n).remove()}})},addElements:function(i,a){var n,d=[];d[0]='input[type="text"]',d[1]="textarea","undefined"==typeof i||"class"==i?(n=".widget-liquid-right .widget .widget-content",e.each(d,function(e,i){t.make_clone(n,i)})):"id"==i&&(n="#"+a+" .widget-content",e.each(d,function(e,i){t.make_clone(n,i)}))},make_clone:function(t,i){e(t+" "+i).each(function(t,a){var n,d,o,l,s=e(a),u=!1;if(l=s.attr("id"),"undefined"==typeof l||-1!=l.indexOf("-number"))return!0;if(_.each(WPGlobusWidgets.disabledMask,function(e){return-1!=l.indexOf(e)?(u=!0,!1):void 0}),u)return!0;if(n=e("#"+l).clone(),e(s).addClass("wpglobus-dialog-field-source hidden"),d=s.attr("name"),e(n).attr("id","wpglobus-"+l),e(n).attr("name","wpglobus-"+d),e(n).attr("data-source-id",l),e(n).attr("class","wpglobus-dialog-field"),e(n).attr("style","width:90%;"),o=WPGlobusCore.TextFilter(e(s).val(),WPGlobusCoreData.language),e(n).val(o),e('<div style="width:20px;" data-type="control" data-source-type="" data-source-id="'+l+'" class="wpglobus-widgets wpglobus_dialog_start wpglobus_dialog_icon"></div>').insertAfter(s),e(n).insertAfter(s),'input[type="text"]'==i&&""!=o){var r=s.parents(".widget").attr("id");e("#"+r+" .in-widget-title").text(": "+o)}})},attachListeners:function(){e(document).ajaxComplete(function(i,a,n){if(-1!=n.data.indexOf("action=save-widget"))if(-1!=n.data.indexOf("delete_widget=1"));else{var d=n.data.split("widget-id=");d=d[1].split("&"),e(".widget-liquid-right .widget").each(function(i,a){var n=e(a).attr("id");-1!==n.indexOf(d[0])&&(t.addElements("id",n),t.wysiwygClean())})}}),e("body").on("change",".wpglobus-dialog-field",function(){var t,i=e(this),a="#"+i.data("source-id"),n="",d="";"undefined"!=typeof a&&(n=e(a).val(),/(\{:|\[:|<!--:)[a-z]{2}/.test(n)?(e.each(WPGlobusCoreData.enabled_languages,function(e,a){t=a==WPGlobusCoreData.language?i.val():WPGlobusCore.TextFilter(n,a,"RETURN_EMPTY"),""!=t&&(d+=WPGlobusCore.addLocaleMarks(t,a))}),e(a).val(d)):e(a).val(i.val()))}),e(document).on("click",".widget-title, .widget-title-action",function(e){e.preventDefault(),t.wysiwygClean()})}};WPGlobusWidgets=e.extend({},WPGlobusWidgets,t)}}(jQuery);